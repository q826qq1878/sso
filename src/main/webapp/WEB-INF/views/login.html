<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="keywords" content="">
    <link rel="stylesheet" href="resources/css/public.css" type="text/css">
    <link href="resources/css/loginV2.css" rel="stylesheet" type="text/css" />
    <title>#if($!portal.pageTitle) $!portal.pageTitle #elseç™»å½•é¡µé¢#end</title>
</head>
<body>
   <!-- header -->
   <header class="all_header">
       <div class="our_website" ><p id="pageName">å•ç‚¹ç™»å½•</p></div>
   </header>
   <!-- content -->
   <section class="content_box">
       <!-- <h4 class="title_big">ç™»å½•Iambuyer</h4> -->
       <div class="AccountShow" id="AccountShow">
           <!-- ç™»å½• -->
           <form id="val_acclogin" action="login" method="post">
	           <div class="content_ys content_login">
	               <div class="input_item">
	                   <p class="input_tips">æ‰‹æœºå·ï¼é‚®ç®±ï¼è´¦æˆ·å</p>
	                   <span class="error_tips error_tips0" id="logninUsers_"></span>
	                   <input type="text" class="input input_white loginUser" id='loginUser' name='loginUser' value="æ‰‹æœºå·ï¼é‚®ç®±ï¼è´¦æˆ·å" onkeyup="LOGINUSER();">
					   <input type="hidden" value="$!ReturnURL" name="ReturnURL" >
	               </div>
	               <div class="input_item">
	                   <p class="input_tips">å¯†ç </p>
	                   <span class="error_tips error_tips0" id="loginPass_"></span>
	                   <input type="password" class="input input_white input_password loginPass" name='loginPass' id='loginPass' value="" style="display:none;" onkeyup="LOGINPASS();"/>
	                   <input type="text" class="input input_white showPwd" value="è¯·è¾“å…¥å¯†ç " id="password"/>                        
	               </div>
	               <div class="other_panel clearfix">
	                   <span class="remebers fl">
	                       <label class="cant-sel"><input class="btn_gray" type="checkbox" name="">è®°ä½æˆ‘çš„ç™»å½•çŠ¶æ€</label>
	                   </span>
	                   <div class="forgets fr">
	                       <a class="forget_link" onclick="account_password()">å¿˜è®°å¯†ç ï¼Ÿ</a>
	                   </div>
	               </div>
	               <div class="login_btn">
	                   <input class="button_l" type="button" id="loginSubmit"  value="ç™»å½•">
	                   <p class="no_account">æ²¡æœ‰è´¦æˆ·<a class="once_register" onclick="account_register()">ç«‹å³æ³¨å†Œ</a></p>
	               </div>
	           </div> 
	           <input type="hidden" value="$!loginUser" id="LonginUser">
	           <input type="hidden" value="$!loginPass" id="LonginPass">


	           <input type="hidden" value="false"  name="checkbox" id="checkbox">
	       </form>
           <!-- æ³¨å†Œ -->
           <form id="val_accReg" action="login" method="post">
	           <div class="content_ys content_register">
	               <div class="input_item">
	                   <p class="input_tips">æ‰‹æœºå·</p>
	                   <span class="error_tips error_tips0 display_a"></span>
	                   <input type="text" class="input input_white RegPhone" id='phone' name="mobile" value="æ‰‹æœºå·" onkeyup="RegPhone();">                        
	               </div>
	               <div class="input_item" id='imgCode' >
	                   <p class="input_tips">éªŒè¯ç </p>
	                   <span class="error_tips error_tips0 display_b"></span>
	                   <input type="text" class="input input_white" id='yzm_code' value="éªŒè¯ç " onkeyup="yzmCode();">
	                   <img class="yzm_img" id="kaptchaImage" src="code">
	               </div>
	               <div class="input_item">
	                   <p class="input_tips">çŸ­ä¿¡éªŒè¯ç </p>
	                   <span class="error_tips error_tips0 display_c"></span>
	                   <input type="text" class="input input_white yzmcode getcode" id="yzmcode" value="çŸ­ä¿¡éªŒè¯ç " onkeyup="sms();">
	                   <span class="get_yzm " id="getcode0" style="color:#9d9d9d;">è·å–éªŒè¯ç </span>
	               </div>
<!-- 	               <div class="input_item">
	                   <p class="input_tips">ç”¨æˆ·å</p>
	                   <span class="error_tips error_tips0 display_f" ></span>
	                   <input type="text" class="input input_white" id="username" name="username" value="ç”¨æˆ·å" onkeyup="zhuce();">                        
	               </div> -->
	               <div class="input_item">
	                   <p class="input_tips">è®¾ç½®å¯†ç </p>
	                   <span class="error_tips error_tips0 display_d"></span>
	                   <input type="password" class="input input_white input_password" id="fir_pwd" type="password"  value="" style="display:none;" onkeyup="firPwd();"/>
	                   <input type="text" class="input input_white showPwd"id="_fir_pwd"  value="è®¾ç½®å¯†ç "/>
					   <input type="hidden" id='ReturnURL' value="$!ReturnURL" name="ReturnURL" >
	               </div>
	               <div class="input_item">
	                   <p class="input_tips">ç¡®è®¤å¯†ç </p>
	                   <span class="error_tips error_tips0 display_e"></span>
	                   <input type="password" class="input input_white input_password" id="two_pwd" type="password" value="" style="display:none;" onkeyup="password();"/>
	                   <input type="text" class="input input_white showPwd" id="_two_pwd" value="ç¡®è®¤å¯†ç ">                        
	               </div>
	              <!--  <div class="other_panel agree" onclick="checkbox();">
	                   <span class="remebers">
	                       <label class="cant-sel"><input class="btn_gray" type="checkbox" name="">æˆ‘å·²åŒæ„ç¨å°é¸­çš„<a class="user_protocol" href="/index.php?m=Web&c=Index&a=xieyi">ã€Šç”¨æˆ·åè®®ã€‹</a></label>
	                   </span>
	               </div> -->
	               <div class="login_btn">
	                   <input class="button_l" type="button" name="" id="phone_zhuce" value="æ³¨å†Œ">
	                   <p class="no_account">å·²æœ‰è´¦æˆ·<a class="once_register" onclick="account_login()">é©¬ä¸Šç™»å½•</a></p>
	               </div>
	           </div>
           </form>     
           <!-- ä¿®æ”¹å¯†ç  -->  
           <div class="content_ys content_password">
               <div class="flow">
                   <ul class="clearfix">
                       <li class="flowitem addcolor fl">
                           <a>1</a>
                           <p class="p_p">èº«ä»½éªŒè¯</p>
                       </li>
                       <li class="flowitem fl">
                           <a>2</a>
                           <p class="p_p">é‡ç½®å¯†ç </p>
                           <p class="line"></p>
                       </li>
                   </ul>
               </div>
               <form id="val_phone" action="login">
	               <div class="find_pasw" id="findPsw1">
	                   <div class="input_item">
	                       <p class="input_tips">æ‰‹æœºå·</p>
	                       <span class="error_tips error_tips0" id="findPhone"></span>
	                       <input type="text" class="input input_white userPhoneCheck" id='phone_' name='phone' oninput="SmsCodeVali();"  value="æ‰‹æœºå·" onkeyup="PHONE();">
	                   </div>
	                   <div class="input_item">
	                       <p class="input_tips">éªŒè¯ç </p>
	                       <span class="error_tips error_tips0" id="findYzm"></span>
	                       <input type="text" class="input input_white" id='yzm_code_' name="login_passwd" oninput="SmsCodeVali();" value="éªŒè¯ç " onkeyup="LOGINPASSWD();">
	                       <img class="yzm_img" src="code" id="kaptchaImage1">
	                   </div>
	                   <div class="input_item">
	                       <p class="input_tips">çŸ­ä¿¡éªŒè¯ç </p>
	                       <span class="error_tips error_tips0" id="smsYZM"></span>
	                       <input type="text" class="input input_white" id="phoneYZM" name="yzm_code" value="çŸ­ä¿¡éªŒè¯ç " onkeyup="PHONEYZM();">
	                       <span class="get_yzm" id="getcode" style="color:#9d9d9d;">è·å–éªŒè¯ç </span>
	                   </div>
	                   <div class="login_btn">
	                       <input class="button_l" type="button" id="findPassword" disabled="disabled" name="" value="æ‰¾å›å¯†ç " onclick="get_passwprd();">
	                   </div>                        
	               </div>
	               </form>
	               <form action="login" id="val_psw">
		               <div class="find_pasw find_pasw2" id="findPsw2">
		                   <div class="input_item">
		                       <p class="input_tips">è®¾ç½®å¯†ç </p>
		                       <span class="error_tips error_tips0" id="setPassword"></span>
		                       <input type="password" class="input input_white input_password " id='pass1' name='pass1' value="" style="display:none;" onkeyup="password1();"/>
		                       <input type="text" class="input input_white showPwd" id='pass1_' value="è®¾ç½®å¯†ç "/>
		                   </div>
		                   <div class="input_item">
		                       <p class="input_tips">ç¡®è®¤å¯†ç </p>
		                       <span class="error_tips error_tips0" id="yesPassword"></span>
		                       <input type="password" class="input input_white input_password " id='pass2' name='pass2' value="" style="display:none;" onkeyup="password2();"/>
		                       <input type="text" class="input input_white showPwd" id='pass2_' value="ç¡®è®¤å¯†ç ">
							   <input type="hidden"  value="$!ReturnURL" name="ReturnURL" >
		                   </div>
		                   <div class="login_btn">
		                       <input class="button_l" type="button" id="phoneSubmit02" disabled="disabled"  value="æäº¤">
		                   </div> 
		               </div>
	           		</form>
               <p class="no_account"><a class="once_register pad_r" onclick="back_login()">è¿”å›ç™»å½•</a><a class="once_register" onclick="back_register()">ç«‹å³æ³¨å†Œ</a></p>
           </div>       
       </div>
   </section>
   <!-- footer -->
   <div class="footer">  
   </div>
<script type="text/javascript">
	var loginName = "ç™»å½•";
	var regName = "æ³¨å†Œ";
	if("$!portal.logHeaderTitle" != ''){
		loginName = "$!portal.logHeaderTitle";
		regName = "$!portal.regHeaderTitle";
	}
</script>
<script type="text/javascript" src="resources/js/jquery-1.10.1.min.js"></script>
<script type="text/javascript" src="resources/js/loginV2.js"></script>
<script src="resources/plugins/validate/jquery.validate.min.js"></script>
<script src="resources/plugins/validate/validate-methods.js"></script>
<script src="resources/plugins/layer/2.4/layer.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="resources/js/loginJS.js"></script>
<script type="text/javascript">
//æ³¨å†Œjséƒ¨åˆ†-----------------------------------------------------------------------------------------------
var patrn=/^(?![0-9]+$)(?![a-zA-Z]+$)(?!([^(0-9a-zA-Z)]|[\(\)])+$)([^(0-9a-zA-Z)]|[\(\)]|[a-zA-Z]|[0-9]){0,180}$/;
var edit_code = false;
var Reg_Phone = false;
var yzm_code = false;
var fir_pwd1 = false;
var two_pwd1 = false;
var checked = false;
//åŠ ä¸Šæ³¨å†Œæäº¤æŒ‰é’®é™åˆ¶
function cancel(){
	$("#phone_zhuce").removeClass("button_yes");
	$("#phone_zhuce").attr("disabled",true); 
}
//å»æ‰æ³¨å†Œæäº¤æŒ‰é’®é™åˆ¶
function confirm(){
	$("#phone_zhuce").addClass('button_yes'); 
	$("#phone_zhuce").attr("disabled",false);
}
/* //åˆ¤æ–­æ˜¯å¦åŒæ„ç”¨æˆ·åè®®
function checkbox(){
	if(checked){
		if($(".btn_gray").is(":checked")){
			checked=true;
		}else{
			checked=false;
		}
		zhuce();
	}else{
		if($(".btn_gray").is(":checked")){
			checked=true;
		}else{
			checked=false;
		}
		zhuce();
	}
} */
//åˆ¤æ–­æ‰€æœ‰å†…å®¹æ˜¯å¦å®Œæˆè°ƒç”¨æŒ‰é’®é™åˆ¶å‡½æ•°
function zhuce(){
	if(Reg_Phone){
		if(edit_code){
			if(yzm_code){
					if(fir_pwd1){
						if(two_pwd1){
							/* if(checked){ */
								confirm();
							/* }else{
								cancel();
							} */
						}else{
							cancel();
						}
				}else
					cancel();
			}else
				cancel();
		}else
			cancel();
	}else
		cancel();
}
//æ‰€æœ‰çš„inputæ·»åŠ keyupæ—¶é—´è§¦å®æ—¶ç›‘æ§æäº¤æŒ‰é’®
$("#phone").keyup(function(){zhuce();});
$("#yzm_code").keyup(function(){zhuce();});
$("#fir_pwd").keyup(function(){zhuce();});
$("#two_pwd").keyup(function(){zhuce();});
$("#yzmcode").keyup(function(){zhuce();});
//end
//æ ¡éªŒæ³¨å†Œæ‰‹æœºå·
$('#phone').on('blur', function(){
	 var phones = $("#phone").val();
	    var data = {phones:phones}
	    if(phones == ''|| phones =='æ‰‹æœºå·'){
	        $(".RegPhone").addClass('error1');
	        $('.display_a').text("æ‰‹æœºå·ç ä¸èƒ½ä¸ºç©º!");
	        Reg_Phone = false;
	        $("#phone").val('');
	        zy();
	        return false;
	    }else if(!isPhone(phones)){
	        $(".RegPhone").addClass('error1');
	        $('.display_a').text("æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®,è¯·é‡æ–°è¾“å…¥!");
	        Reg_Phone = false;
	        zy();
	        return false;
	    }else{
	        $(".RegPhone").removeClass("error1");
	        jQuery.getJSON('userPhoneCheck?userPhone='+ phones ,"",function(d){
	            if(d.ret != 200){
	                $(".RegPhone").addClass('error1');
	                $('.display_a').text("è¯¥æ‰‹æœºå·ç å·²æ³¨å†Œ,è¯·é‡æ–°è¾“å…¥!");
	                Reg_Phone = false;
	                zy();
	                return false;
	            }else{
	            	zhuce();
	                Reg_Phone = true;
	            	zy();
	                $(".RegPhone").removeClass("error1");
	                $('.display_a').text('');
	                
	            }
	        });
	        zhuce();
	        zy();
	        $('.display_a').text('');
	    }
});
function RegPhone(){
	$(".RegPhone").removeClass("error1");
	$(".display_a").text('');
	zhuce();
}
//æ ¡éªŒæ³¨å†ŒéªŒè¯ç 
$('#yzm_code').on('blur', function(){
	var editcode = $('#yzm_code').val();
    if(editcode == '' || editcode=='éªŒè¯ç '){
        $("#yzm_code").addClass('error1');
        $('.display_b').text("å›¾ç‰‡éªŒè¯ç ä¸èƒ½ä¸ºç©º!");
        $("#yzm_code").val('');
        edit_code = false;
        zy();
        return false;
    }else{
        $("#yzm_code").removeClass("error1");
        jQuery.getJSON("checkCode?code=" + editcode,"",function(d){
            if(d.ret != 200){
                $("#yzm_code").addClass('error1');
                $('.display_b').text("å›¾ç‰‡éªŒè¯ç é”™è¯¯,è¯·é‡æ–°è¾“å…¥!");
                edit_code = false;
                zy();
                return false;
            }else{
            	zhuce();
            	$('.display_b').text('');
            	edit_code = true;
            	zy();
            	$("#yzm_code").removeClass('error1');
            }
        });
     }
});
function yzmCode(){
	$('.display_b').text('');
	$("#yzm_code").removeClass('error1');
	zhuce();
}
//å¦‚æœæ‰‹æœºå·æ­£ç¡®å’Œå›¾åƒéªŒè¯ç æ­£ç¡®å–æ¶ˆè·å–éªŒè¯ç çš„é™åˆ¶
function zy(){
	if(Reg_Phone){
		if(edit_code){
			$("#getcode0").attr("onclick","fg_txt(1);");
			$("#getcode0").css("color","#02C2A2");
		}else{
			$("#getcode0").removeAttr("onclick","");
			$("#getcode0").css("color","#9d9d9d");
		}
	}else{
		$("#getcode0").removeAttr("onclick","");
		$("#getcode0").css("color","#9d9d9d");
	}
}
//æ ¡éªŒçŸ­ä¿¡éªŒè¯ç 
$('#yzmcode').on('blur', function(){
    var yzmcode = $("#yzmcode").val();
    var datas = {yzmcode:yzmcode}
    if(yzmcode == '' || yzmcode=='çŸ­ä¿¡éªŒè¯ç '){
        $(".yzmcode").addClass('error1');
        $('.display_c').text("çŸ­ä¿¡éªŒè¯ç ä¸èƒ½ä¸ºç©º!");
        $('#yzmcode').val('');
        yzm_code = false;
        zy();
        return false;
    }else{
    	zhuce();
    	$(".yzmcode").removeClass('error1');
    	yzm_code = true;
        zy();
    }
});
function sms(){
	$('.display_c').text('');
	$("#yzmcode").removeClass('error1');
	zhuce();
}
function firPwd(){
	$('.display_d').text('');
	$("#fir_pwd").removeClass('error1');
	zhuce();
}
function password(){
	var fir_pwd = $("#fir_pwd").val();
	var two_pwd = $("#two_pwd").val();
	if(fir_pwd==two_pwd){
		two_pwd1=true;
		$('.display_e').text('');
		$("#two_pwd").removeClass('error1');
		zhuce();
	}else{
		two_pwd1=false;
		zhuce();
	}
}
//åˆ¤æ–­æ³¨å†Œå¯†ç 
$('#fir_pwd').on('blur', function(){
    var fir_pwd = $(this).val();
    if(fir_pwd == ''){
        $("#fir_pwd").addClass('error1');
        $("#_fir_pwd").addClass('error1');
        $('.display_d').text("å¯†ç ä¸èƒ½ä¸ºç©º!");
        $("#fir_pwd").val('');
        $("#_fir_pwd").val('');
        fir_pwd1 = false;
        return false;
    }else if(!patrn.test(fir_pwd)){
        $("#fir_pwd").addClass('error1');
        $('.display_d').text("å¯†ç å¿…é¡»ä¸ºæ‹¼éŸ³+æ•°å­—ç»„åˆ,è¯·é‡æ–°è¾“å…¥!");
        fir_pwd1 = false;
        return false;
    }else if(fir_pwd.length < 6 || fir_pwd.length>18){
        $("#fir_pwd").addClass('error1');
        $('.display_d').text("å¯†ç é•¿åº¦å¿…é¡»ä¸º6-18ä½!");
        fir_pwd1 = false;
        return false;
    }else{
    	zhuce();
        $("#fir_pwd").removeClass("error1");
        fir_pwd1 = true;
        $(".display_d").text('');
    }
});
//åˆ¤æ–­ç¬¬äºŒæ¬¡è¾“å…¥çš„æ³¨å†Œå¯†ç 
$('#two_pwd').on('blur', function(){
    var fir_pwd = $("#fir_pwd").val();
    var two_pwd = $(this).val();
    if(two_pwd=='' || two_pwd=='ç¡®è®¤å¯†ç '){
    	$("#two_pwd").addClass('error1');
    	$("#_two_pwd").addClass('error1');
        $(".display_e").text("ç¡®è®¤å¯†ç ä¸èƒ½ä¸ºç©º!");
        $("#_two_pwd").val('');
        two_pwd1 = false;
        return false;
    }else{
	    if(two_pwd != fir_pwd){
	        $("#two_pwd").addClass('error1');
	        $(".display_e").text("ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´!");
	        two_pwd1 = false;
	        return false;
	    }else{
	        $("#two_pwd").removeClass("error1");
	        two_pwd1 = true;
	        $(".display_e").text('');
	    }
    }
   
});
$("#phone_zhuce").click(function(){
    if(edit_code && Reg_Phone && yzm_code && fir_pwd1 && two_pwd1){
        var registerCodeURL = "register?code="+$("#yzmcode").val();
        //æ‹¼æ¥æ³¨å†Œä¿¡æ¯
        var json = {"mobile" : $("#phone").val() ,"username": $("#phone").val(), "password" : $("#fir_pwd").val() };
        //æäº¤è¡¨å•
        jQuery.ajax({
            type:"post",
            data:JSON.stringify(json),
            dataType:"json",
            contentType:'application/json',
            async: false,
            url:registerCodeURL,
            success:function(data){
                if(data.ret == "200"){
                    layer.open({
                        content: 'æ­å–œæ‚¨æ³¨å†ŒæˆåŠŸğŸ‰,é©¬ä¸Šç™»é™†è¯•è¯•çœ‹å§',
                        yes: function(index, layero){
                             window.location.href = 'login?ReturnURL=$!ReturnURL';
                        },
                        cancel: function(index, layero){
                            window.location.href = 'login?ReturnURL=$!ReturnURL';
                        }
                    });
                }else{
                    layer.msg(data.msg, {icon: 2});
                	return ;
                }
            }
        });
    }else{
        return false;
    }
});

//---------------------------------æ³¨å†Œjs   end--------------------------------



//æ‰¾å›å¯†ç jséƒ¨åˆ†-----------------------------------------------------------------------------------------------
//åˆ¤æ–­ä¸¤æ¬¡è¾“å…¥çš„å¯†ç æ˜¯å¦ä¸€è‡´
var pass1=false;
var pass2=false;
function password1(){
	 $("#pass1").removeClass("error1");
     $("#setPassword").text('');
}
function password2(){
	$("#pass2").removeClass("error1");
    $("#yesPassword").text('');
	var pass =$("#pass1").val();
	var pass_ =$("#pass2").val();
	if($("#setPassword").text()=='' && pass!='' && pass==pass_){
		pass1=true;
		pass2=true;
		$('#phoneSubmit02').attr("disabled",false); 
		$('#phoneSubmit02').addClass('button_yes'); 
	}
}
function pass(){
	if(pass1){
		if(pass2){
			$("#phoneSubmit02").addClass('button_yes'); 
			$("#phoneSubmit02").attr("disabled",false);
		}else{
			$("#phoneSubmit02").removeClass("button_yes");
			$("#phoneSubmit02").attr("disabled",true); 
		}
	}else{
		$("#phoneSubmit02").removeClass("button_yes");
		$("#phoneSubmit02").attr("disabled",true); 
	}
}
var val_psw = $("#val_psw").validate({
    errorPlacement: function(error, element) {
        $('.err_tips').empty();
        error.appendTo($('.err_tips'));
    },
    onfocusout:function(element) { $('.err_tips').empty();$(element).valid(); },
    submitHandler: function(form){   //è¡¨å•æäº¤å¥æŸ„,ä¸ºä¸€å›è°ƒå‡½æ•°ï¼Œå¸¦ä¸€ä¸ªå‚æ•°ï¼šform
        var phoneVAL = $("#phone_").val();
        var yzmcode = $("#phoneYZM").val();
        var pass = $("#pass1").val();
	        //è®¤è¯çŸ­ä¿¡æ˜¯å¦OK
	        var registerCodeURL = "updatePass?code="+yzmcode + "&pass="+pass + "&phone="+phoneVAL;
	        //æäº¤è¡¨å•
	        jQuery.ajax({
	            type:"get",
	            dataType:"json",
	            contentType:'application/json',
	            async: false,
	            url:registerCodeURL,
	            success:function(data){
	                if(data.ret == "200"){
	                    layer.open({
	                        content: 'æ­å–œæ‚¨ä¿®æ”¹æˆåŠŸğŸ‰,é©¬ä¸Šç™»é™†è¯•è¯•çœ‹å§',
	                        yes: function(index, layero){
	                            window.location.href = 'login?ReturnURL=$!ReturnURL';
	                        },
	                        cancel: function(index, layero){
	                            window.location.href = 'login?ReturnURL=$!ReturnURL';
	                        }
	                    });
	                }else{
	                	$("#findPsw1").css("display","block");
	                	$("#findPsw2").css("display","none");
	                    layer.msg(data.msg, {icon: 2});
	                }
	            }
	        });

    }
});
$("#phoneSubmit02").click(function() {
	if(pass1 && pass2){
	    if(val_psw.form()){ //è‹¥éªŒè¯é€šè¿‡ï¼Œåˆ™è°ƒç”¨ä¿®æ”¹æ–¹æ³•
	        //æäº¤è¡¨å•
	        $("#val_psw").submit();
	    }
	}
});

$('#pass2').on('blur', function(){
	var pass1 =$("#pass1").val();
	var pass2 =$("#pass2").val();
	if(pass2=='' || pass2=='ç¡®è®¤å¯†ç '){
		$("#yesPassword").text('å¯†ç ä¸èƒ½ä¸ºç©º');
		$("#pass2_").addClass('error1');
		$("#pass2").addClass('error1');
		$("#pass2_").val('');
		$("#phoneSubmit02").removeClass("button_yes");
		$("#phoneSubmit02").attr("disabled",true); 
	}else if(pass1!=pass2){
		$("#yesPassword").text('ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´');
		$("#pass2_").addClass('error1');
		$("pass2").addClass('error1');
		$("#pass2_").val('');
		$("#phoneSubmit02").removeClass("button_yes");
		$("#phoneSubmit02").attr("disabled",true); 
	}else{
		 $("#pass2_").removeClass("error1");
		 $("#pass2").removeClass("error1");
	     $("#yesPassword").text('');
		 $('#phoneSubmit02').addClass('button_yes'); 
		 $('#phoneSubmit02').attr("disabled",false); 
	}
})
$('#pass1').on('blur', function(){
	var pass1 =$("#pass1").val();
	if(pass1=='' || pass1=='è®¾ç½®å¯†ç '){
		$("#setPassword").text('å¯†ç ä¸èƒ½ä¸ºç©º');
		$("#pass1_").addClass('error1');
		$("#pass1").addClass('error1');
		$("#pass1_").val('');
		$("#phoneSubmit02").removeClass("button_yes");
		$("#phoneSubmit02").attr("disabled",true); 
	}else if(!patrn.test(pass1)){
        $("#pass1_").addClass('error1');
        $("#pass1").addClass('error1');
        $('#setPassword').text("å¯†ç å¿…é¡»ä¸ºæ‹¼éŸ³+æ•°å­—ç»„åˆ,è¯·é‡æ–°è¾“å…¥!");
        $("#pass1_").val('');
        $("#phoneSubmit02").removeClass("button_yes");
		$("#phoneSubmit02").attr("disabled",true); 
    }else if(pass1.length < 6 || pass1.length>18){
        $("#pass1").addClass('error1');
        $("#pass1").addClass('error1');
        $('#setPassword').text("å¯†ç é•¿åº¦å¿…é¡»ä¸º6-18ä½!");
        $("#pass1_").val('');
        $("#phoneSubmit02").removeClass("button_yes");
		$("#phoneSubmit02").attr("disabled",true); 
    }else{
        $("#pass1_").removeClass("error1");
        $("#pass1").removeClass("error1");
        $("#setPassword").text('');
        var phoneVAL = $("#phone_").val();
        var isNameURL = "newPasssword?pass="+pass1 + "&phone="+phoneVAL;
	    var isNameURLRetStr = sendAjax(isNameURL);
	    if(isNameURLRetStr != ""){
	    	$("#pass1").addClass("error1");
            $("#pass1").addClass("error1");
            $("#setPassword").text("æ–°å¯†ç ä¸èƒ½ä¸æ—§å¯†ç é‡å¤!");
            $("#phoneSubmit02").removeClass("button_yes");
    		$("#phoneSubmit02").attr("disabled",true); 
	    }
	}
})

function PHONE(){
	$("#findPhone").text("");
	$("#phone_").removeClass("error1");
}
function LOGINPASSWD(){
	$("#findYzm").text("");
	$("#yzm_code_").removeClass("error1");
}
function PHONEYZM(){
	$("#smsYZM").text("");
	$("#phoneYZM").removeClass("error1");
}
//åˆ¤æ–­æ˜¯å¦å–æ¶ˆå¿˜è®°å¯†ç æäº¤æŒ‰é’®é™åˆ¶
function buttonJY(){
	if($("#phone_").val()!='' && $("#phone_").val()!='æ‰‹æœºå·ï¼é‚®ç®±ï¼è´¦æˆ·å'){
		if($("#yzm_code_").val()!='' && $("#yzm_code_").val()!='éªŒè¯ç '){
			if($("#phoneYZM").val()!='' && $("#phoneYZM").val()!='çŸ­ä¿¡éªŒè¯ç '){
				$("#findPassword").addClass('button_yes'); 
				$("#findPassword").attr("disabled",false);
			}else{
				$("#findPassword").removeClass("button_yes");
				$("#findPassword").attr("disabled",true); 
			}
		}else{
			$("#findPassword").removeClass("button_yes");
			$("#findPassword").attr("disabled",true); 
		}
	}else{
		$("#findPassword").removeClass("button_yes");
		$("#findPassword").attr("disabled",true); 
	}
}
$('#phone_','#yzm_code_','#phoneYZM').keyup();
$("#yzm_code_").keyup(function(){buttonJY();});
$("#phoneYZM").keyup(function(){buttonJY();});
$("#phone_").keyup(function(){buttonJY();});
//end
//æ ¡éªŒæ‰‹æœºå·ç 
var findYZM=false;
var FINDPHONE=false;
function SmsCodeVali(){
    var val = $("#phone_").val();
    var falg = true;
    FINDPHONE=true;
    if(val == undefined || val == ""){
        falg = false;
        FINDPHONE=false;
        findMM();
    }
    if((val.length == 11 && /^1[34578]\d{9}$/.test(val))){
    	var isNameURL = "userPhoneCheck?userPhone="+val;
	    var isNameURLRetStr = sendAjax(isNameURL);
	    if(isNameURLRetStr != ""){
	    	$("#findPhone").text("");
	    	 $("#phone_").removeClass("error1");
	        falg = true;
	        findMM();
	    }else{
	    	findYZM=false;
	    	FINDPHONE=false;
	    	findMM();
	    	$("#findPhone").text("è¯¥æ‰‹æœºå·æœªæ³¨å†Œ!");
	    }
    	findMM();
    }else{
        falg = false;
        FINDPHONE=false;
        findMM();
    }
}
//ç»™è·å–éªŒè¯ç æ·»åŠ onclickäº‹ä»¶
function findMM(){
	if(FINDPHONE){
		if(findYZM){
			$("#getcode").attr("onclick","fg_txt(0);");
			$("#getcode").css("color","#02C2A2");
		}else{
			$("#getcode").removeAttr("onclick","");
			$("#getcode").css("color","#9d9d9d");
		}
	}else{
		$("#getcode").removeAttr("onclick","");
		$("#getcode").css("color","#9d9d9d");
	}
}
$('#yzm_code_').on('blur', function(){
	if($("#yzm_code_").val()=='' || $("#yzm_code_").val()=='éªŒè¯ç '){
		$("#findYzm").text('éªŒè¯ç ä¸èƒ½ä¸ºç©º!');
		$("#yzm_code_").addClass('error1');
		$("#yzm_code_").val('');
	}else{
		//æ ¡éªŒéªŒè¯ç 
	    var yzm_code = $("#yzm_code_").val();
	    if(yzm_code == undefined || yzm_code == "" || yzm_code.length != 4 ){
	        falg = false;
	        findYZM=false;
	        findMM();
	    }else{
	        var checkCodeURL = "checkCode?code="+yzm_code;
	        var checkCodeURLRetStr = sendAjax(checkCodeURL);
	        if(checkCodeURLRetStr == ""){
	        	$("#findYzm").text('');
	        	findYZM=true;
	        	findMM();
	        }else{
	            falg = false;
	            $('.err_tips').empty();
	            $("#findYzm").text(checkCodeURLRetStr);
	        }
	    }
	}
});
$('#phoneYZM').on('blur', function(){
	if($("#phoneYZM").val()=='' || $("#phoneYZM").val()=='çŸ­ä¿¡éªŒè¯ç '){
		$("#smsYZM").text('çŸ­ä¿¡éªŒè¯ç ä¸èƒ½ä¸ºç©º!');
		$("#phoneYZM").addClass('error1');
		$("#phoneYZM").val('');
	}
});
$('#phone_').on('blur', function(){
	var val = $("#phone_").val();
	if(val=='' || val=='æ‰‹æœºå·'){
		 $("#findPhone").text("æ‰‹æœºå·ç ä¸èƒ½ä¸ºç©º!");
		 $("#phone_").addClass('error1');
		 $("#phone_").val('');
		 findMM();
		 return false;
	}else{
		if((val.length == 11 && /^1[34578]\d{9}$/.test(val))){
			falg = false;
			var isNameURL = "userPhoneCheck?userPhone="+val;
		    var isNameURLRetStr = sendAjax(isNameURL);
		    if(isNameURLRetStr != ""){
		    	$("#findPhone").text("");
		    	 $("#phone_").removeClass("error1");
		        falg = true;
		        findMM();
		    }else{
		    	findYZM=false;
		    	FINDPHONE=false;
		    	findMM();
		    	$("#findPhone").text("è¯¥æ‰‹æœºå·æœªæ³¨å†Œ!");
		    }
		}else{
			findMM();
			FINDPHONE=false;
			$("#findPhone").text("æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®!");
		}
	}
})
var val_phone = $("#val_phone").validate({
    errorPlacement: function(error, element) {
        $('.err_tips').empty();
        error.appendTo($('.err_tips'));
    },
    onfocusout:function(element) { $('.err_tips').empty();$(element).valid(); },
    submitHandler: function(form){   //è¡¨å•æäº¤å¥æŸ„,ä¸ºä¸€å›è°ƒå‡½æ•°ï¼Œå¸¦ä¸€ä¸ªå‚æ•°ï¼šform
        //è®¤è¯çŸ­ä¿¡éªŒè¯ç æ˜¯å¦ok
        var phoneVAL = $("#phone_").val();
        var yzmcode = $("#phoneYZM").val();
        var findPhoneSmsCheckRetStr = sendAjax("findPhoneSmsCheck?phone="+phoneVAL + "&code=" + yzmcode );
        if(findPhoneSmsCheckRetStr == ""){//è®¤è¯æˆåŠŸ
            $(".find_tw").removeClass('none_display');
            $(".find_on").addClass('none_display');
            $(".AccountShow a").addClass('a_color');
            $(".AccountShow .p_p").addClass('p_color');
            $(".AccountShow .line").addClass('line_color');
            set_passwprd();
        }else{
            layer.msg(findPhoneSmsCheckRetStr, {icon: 2});
        }
    }
});
$("#findPassword").click(function() {
	if(FINDPHONE){
		if(findYZM){
			if($("#phoneYZM").val()!=''){
				$("#val_phone").submit();
			}
		}else{
			$("#yzm_code_").addClass('error1');
			$("#findYzm").text('éªŒè¯ç é”™è¯¯!');
		}
	}
}) 
var newCountdown = 0;
 //è·å–éªŒè¯ç 
function fg_txt(obj) {
	 var phoneVAL;
	 if(obj==1){
	     phoneVAL = $("#phone").val();
	     var phoneSmsURL = "phoneSms?phone="+phoneVAL;
	 }else{
		 phoneVAL = $("#phone_").val(); 
		 var phoneSmsURL = "findPhoneSms?phone="+phoneVAL;
	 }
     var phoneSmsURLRetStr = sendAjax(phoneSmsURL);
     if(phoneSmsURLRetStr == ""){
         newCountdown = 60;
         if(obj==1){
        	 $("#getcode0").removeAttr("onclick","");
        	 newSettime(newCountdown);
         }else{
        	 $("#getcode").removeAttr("onclick","");
         	newSettime_(newCountdown);
         }
     }else{
         newCountdown = 0;
         layer.msg(phoneSmsURLRetStr, {icon: 2});
     }
 }
 
 //60ç§’å€’è®¡æ—¶å‡½æ•°
 function newSettime_() {
     if (newCountdown == 0) {
    	 $("#getcode").text("è·å–éªŒè¯ç ").css("color","#02C2A2");
    	 $("#getcode").attr("onclick","fg_txt(1);");
     } else {
    	 $("#getcode").text("é‡æ–°å‘é€("+newCountdown+")").css("color","#9d9d9d");
         newCountdown--;
	     setTimeout(function() {
	         newSettime_();
	     },1000)
     }
 }
 function newSettime() {
     if (newCountdown == 0) {
    	 $("#getcode0").text("è·å–éªŒè¯ç ").css("color","#02C2A2");
    	 $("#getcode0").attr("onclick","fg_txt(0);");
     } else {
    	 $("#getcode0").text("é‡æ–°å‘é€("+newCountdown+")").css("color","#9d9d9d");
         newCountdown--;
	     setTimeout(function() {
	         newSettime();
	     },1000)
     }
 }
//---------------------------------æ‰¾å›å¯†ç js   end--------------------------------
//å…¬å…±jséƒ¨åˆ†-----------------------------------------------------------------------------------------------
//éªŒè¯é‚®ç®±çš„æ–¹æ³•
function isEmail(useremail) {
    var validates = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/ ;
    if (validates.test(useremail))
        return true;
    else
        return;
}
function isPhone(phoneNum) {
    var validate = /^(0|86|17951)?(13[0-9]|14[57]|15[012356789]|18[0-9]|14[57]|17[0356789])[0-9]{8}$/;
    if (validate.test(phoneNum))
        return true;
    else
        return;
}
//å‘é€Ajaxçš„æ–¹æ³•
function sendAjax(url){
    var falg ;
    jQuery.ajax({
        type:"get",
        dataType:"json",
        contentType:'application/json',
        async: false,
        url:url,
        success:function(data){
            if(data.ret == "200"){
                falg =  "";
            }else{
                falg = data.msg;
            }
        }
    });
    return falg;
}
//-----------------------------------end-----------------------------
//å›¾å½¢éªŒè¯ç ------ä¸€ä¸ªæ³¨å†Œçš„éªŒè¯ç ,ä¸€ä¸ªå¿˜è®°å¯†ç çš„éªŒè¯ç 
jQuery('#kaptchaImage').on("click",function () {jQuery(this).hide().attr('src', 'code?' + Math.floor(Math.random()*100) ).fadeIn(); });
jQuery('#kaptchaImage1').on("click",function () {jQuery(this).hide().attr('src', 'code?' + Math.floor(Math.random()*100) ).fadeIn(); });
//ç™»å½•jséƒ¨åˆ†
var phoneTrue = false;
var passwordTrue = false;
function loginYZ(){
	if(phoneTrue && passwordTrue){
		$("#loginSubmit").addClass('button_yes'); 
		$("#loginSubmit").attr("disabled",false);
	}else{
		$("#loginSubmit").removeClass("button_yes");
		$("#loginSubmit").attr("disabled",true); 
	}
}
//åˆ¤æ–­å¦‚æœç”¨æˆ·å‹¾é€‰äº†è®°ä½æˆ‘çš„ç™»å½•çŠ¶æ€å°±åœ¨åˆå§‹åŒ–çš„æ—¶å€™ç»™è´¦å·å¯†ç æ¡†èµ‹å€¼
if($("#LonginUser").val()!=''){
	$("#loginUser").val($("#LonginUser").val());
	$('#loginUser').blur();//è§¦å‘è·å–ç„¦ç‚¹äº‹ä»¶
}
if($("#LonginPass").val()!=''){
	$("#loginPass").val($("#LonginPass").val());
	$('#loginPass').blur();
	$('#password').focus(); 
}
if($("#loginUser").val()=='' || $("#loginUser").val()=="æ‰‹æœºå·ï¼é‚®ç®±ï¼è´¦æˆ·å" || $("#loginPass").val()!='' ){
	$('#loginSubmit').attr("disabled",true); 
}
//åˆ¤æ–­æ˜¯å¦éƒ½è¾“å…¥å–æ¶ˆç™»å½•æŒ‰é’®çš„æ§åˆ¶
/* function keyup(){
	if($("#loginUser").val()!='' && $("#loginUser").val()!="æ‰‹æœºå·ï¼é‚®ç®±ï¼è´¦æˆ·å"){
		if($("#loginPass").val()!='' ){
			confirm_();
		}else{
			cancel_();
		}
	}else{
		cancel_();
	}
}
function cancel_(){
	$("#loginSubmit").removeClass("button_yes");
	$("#loginSubmit").attr("disabled",true); 
}
function confirm_(){
	$("#loginSubmit").addClass('button_yes'); 
	$("#loginSubmit").attr("disabled",false);
} */
//åå°å¤„ç†å®Œåˆ¤æ–­è´¦å·å¯†ç ä¸æ­£ç¡®ä¹‹åçš„æç¤º
var msg = "$!msg";
if(msg != ""){
	if(msg=="ç”¨æˆ·åä¸æ­£ç¡®"){
		$("#logninUsers_").empty();
		$("#logninUsers_").text(msg);
		$('#loginSubmit').addClass('button_yes'); 
		$('#loginSubmit').attr("disabled",false); 
	}
	if(msg=="å¯†ç ä¸æ­£ç¡®"){
		$("#loginPass_").empty();
		$("#loginPass_").text(msg);
		$('#loginSubmit').addClass('button_yes'); 
		$('#loginSubmit').attr("disabled",false); 
	}
}
var validator = $("#val_acclogin").validate({
  errorPlacement: function(error, element) {
      $('.err_tip').empty();
      error.appendTo($('.err_tip'));
  },
  onfocusout:function(element) { $(element).valid(); },
  submitHandler: function(form){   //è¡¨å•æäº¤å¥æŸ„,ä¸ºä¸€å›è°ƒå‡½æ•°ï¼Œå¸¦ä¸€ä¸ªå‚æ•°ï¼šform
      form.submit();   //æäº¤è¡¨å•
  },
  messages:{
      loginUser:{
          required:"ç”¨æˆ·åä¸èƒ½ä¸ºç©º!"
      },
      loginPass:{
          required: "å¯†ç ä¸èƒ½ä¸ºç©º!"
      }
  }
});
$("#loginSubmit").click(function() {
	if(validator.form()){ //è‹¥éªŒè¯é€šè¿‡ï¼Œåˆ™è°ƒç”¨ä¿®æ”¹æ–¹æ³•
   	$("#val_acclogin").submit();
   }
});
$('.loginUser').on('blur', function(){
    var phones = $(this).val();
    var data = {phones:phones}
    if(phones == '' || phones =="æ‰‹æœºå·ï¼é‚®ç®±ï¼è´¦æˆ·å"){
        $(".loginUser").addClass('error1');
        $("#logninUsers_").text("æ‰‹æœºå·ç ä¸èƒ½ä¸ºç©º!");
        Reg_Phone = false;
        $("#loginUser").val('');
        phoneTrue = false;
        loginYZ();
        return false;
    }else if(!isPhone(phones)){
        $(".loginUser").addClass('error1');
        $("#logninUsers_").text("æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®,è¯·é‡æ–°è¾“å…¥!");
        Reg_Phone = false;
        phoneTrue = false;
        loginYZ();
    }else{
    	$("#loginUser").removeClass("error1");
        $("#logninUsers_").text('');
        phoneTrue = true;
        loginYZ();
    }
});
$('.loginPass').on('blur', function(){
	var fir_pwd = $(this).val();
    if(fir_pwd == '' ){
        $("#password").addClass('error1');
        $("#loginPass").addClass('error1');
        $("#loginPass_").text("å¯†ç ä¸èƒ½ä¸ºç©º!");
        $("#password").val('');
        passwordTrue = false;
        loginYZ();
        return false;
    }else if(!patrn.test(fir_pwd)){
        $("#password").addClass('error1');
        $("#loginPass").addClass('error1');
        $("#loginPass_").text("å¯†ç å¿…é¡»ä¸ºæ‹¼éŸ³+æ•°å­—ç»„åˆ,è¯·é‡æ–°è¾“å…¥!");
        passwordTrue = false;
        loginYZ();
        return false;
    }else if(fir_pwd.length < 6 || fir_pwd.length>18){
        $("#password").addClass('error1');
        $("#loginPass").addClass('error1');
        $("#loginPass_").text("å¯†ç é•¿åº¦å¿…é¡»ä¸º6-18ä½!");
        passwordTrue = false;
        loginYZ();
        return false;
    }else{
        $("#password").removeClass("error1");
        $("#loginPass").removeClass("error1");
        $("#loginPass_").text('');
        passwordTrue = true;
        loginYZ();
    }
});
function LOGINUSER(){
		$("#loginUser").removeClass("error1");
	    $("#logninUsers_").text('');
}
function LOGINPASS(){
    $("#loginPass").removeClass("error1");
    $("#loginPass_").text('');
	if(phoneTrue){
		$("#loginSubmit").addClass('button_yes'); 
		$("#loginSubmit").attr("disabled",false);
	}

}
//åˆ¤æ–­æ˜¯å¦éœ€è¦è·³è½¬æ³¨å†Œé¡µé¢
$(function(){
	(function ($) {	
		jQuery.getUrlParam = function (name) {
		    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
		    var r = window.location.search.substr(1).match(reg);
		    if (r != null) return unescape(r[2]); return null;
		   }
		  })(jQuery);
	var type =jQuery.getUrlParam('type');
	if(type==2){
		account_register();
	}
})
//---------------------------------ç™»å½•js   end--------------------------------
$(document).keyup(function(event){
	  if(event.keyCode ==13){
		  if($(".content_login").css("display")=='block'){
			  if($("#loginPass_").text()=='' && $("#logninUsers_").text()==''){
	 			  $("#loginSubmit").trigger("click");
			  }
		  }
		  if($(".content_register").css("display")=='block'){
			  $("#phone_zhuce").trigger("click");
		  }
		  if($("#findPsw1").css("display")=='block'){
			  if(FINDPHONE){
					if(findYZM){
						if($("#phoneYZM").val()!=''){
							$("#val_phone").submit();
						}
					}else{
						$("#yzm_code_").addClass('error1');
						$("#findYzm").text('éªŒè¯ç é”™è¯¯!');
					}
				}
		  } 
		  if($("#findPsw2").css("display")=='block'){
			  if($("#pass1").val()!='' && $("#pass2").val()!='' && $("#pass1").val()==$("#pass2").val()){
				  $("#phoneSubmit02").trigger("click");
			  }
		  } 
	  }
	});
</script>
<!-- //ç‚¹å‡»å›è½¦è§¦å‘æäº¤ -->
<input type="button" onclick="noClick()" style="margin-top:-1024px;" id="noUseButton" /> 

</body>
</html>